# hw definition file for processing by chibios_pins.py

# MCU class and specific type
MCU STM32F4xx STM32F412Rx

# bootloader starts firmware at 64k
FLASH_SIZE_KB 1024
FLASH_RESERVE_START_KB 64


# store parameters in pages 2 and 3
STORAGE_FLASH_PAGE 2
define HAL_STORAGE_SIZE 8192

# board ID for firmware load
APJ_BOARD_ID 1001

# setup build for a peripheral firmware
env AP_PERIPH 1

STM32_ST_USE_TIMER 5

# enable watchdog

# crystal frequency
OSCILLATOR_HZ 8000000

define CH_CFG_ST_FREQUENCY 1000000

STDOUT_SERIAL SD1
STDOUT_BAUDRATE 57600

# order of UARTs
SERIAL_ORDER USART1 EMPTY EMPTY EMPTY

# a LED to flash
#PB12 LED OUTPUT LOW

# USART1 for debug
PB6 USART1_TX USART1 NODMA
PB7 USART1_RX USART1 NODMA
define HAL_SERIAL0_BAUD_DEFAULT 57600

# SWD debugging
PA13 JTMS-SWDIO SWD
PA14 JTCK-SWCLK SWD

#ADC
PA0 BATT_VOLTAGE_SENS ADC1 SCALE(1)
PA1 BATT_CURRENT_SENS ADC1 SCALE(1)

#battery setup
define HAL_BATT_VOLT_PIN 0
define HAL_BATT_CURR_PIN 1
define HAL_BATT_VOLT_SCALE 12
define HAL_BATT_CURR_SCALE 1
define HAL_BATT_MONITOR_DEFAULT 8 
# Enable RAMTROM parameter storage.
#define HAL_WITH_RAMTRON 1

# enable CAN support
PB8 CAN1_RX CAN1
PB9 CAN1_TX CAN1
PB5 GPIO_CAN1_SILENT OUTPUT PUSHPULL SPEED_LOW LOW


#GPIO LED
#define HAL_HAVE_PIXRACER_LED

PB13 LED_GREEN OUTPUT LOW GPIO(34)
PB14 LED_RED OUTPUT LOW GPIO(35) 
PB15 LED_BLUE OUTPUT LOW GPIO(36)

define HAL_GPIO_LED_ON 0
define HAL_GPIO_LED_OFF 1
 
define HAL_GPIO_A_LED_PIN 34
define HAL_GPIO_B_LED_PIN 35
define HAL_GPIO_C_LED_PIN 36

define CAN_APP_NODE_NAME "org.ardupilot.led"

define HAL_PERIPH_ENABLE_NOTIFY 1
define HAL_PERIPH_ENABLE_RC_OUT

define HAL_PERIPH_ENABLE_BATTERY 1
define AP_BATTERY_UAVCAN_BATTERYINFO_ENABLED 1
define HAL_ENABLE_LIBUAVCAN_DRIVERS 1

#define HAL_PERIPH_NEOPIXEL_CHAN_WITHOUT_NOTIFY
define HAL_NO_MONITOR_THREAD
define HAL_DEVICE_THREAD_STACK 768

#define AP_TEMPERATURE_SENSOR_ENABLED 1
# we setup a small defaults.parm
#define AP_PARAM_MAX_EMBEDDED_PARAM 256

